<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>Cat & Mouse Hunt – Mobile</title>
    <style>
      html,
      body {
        margin: 0;
        background: #0e0e10;
        color: #eee;
        font: 14px system-ui, -apple-system, Segoe UI, Roboto, Arial;
      }
      h1 {
        margin: 8px 0 2px;
        text-align: center;
      }
      small {
        color: #9aa;
        display: block;
        text-align: center;
        margin-bottom: 10px;
      }
      .wrap {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 8px;
      }
      .game {
        position: relative;
        border: 1px solid #2a2a2e;
        border-radius: 14px;
        overflow: hidden;
        outline: none;
        background: #151518;
        margin: 0 auto;
      }
      .hud {
        position: absolute;
        top: 6px;
        left: 6px;
        display: flex;
        gap: 6px;
        z-index: 3;
      }
      .hud div {
        background: #1b1b1f;
        padding: 6px 10px;
        border-radius: 10px;
      }
      .btn {
        background: #3a3a40;
        border: 0;
        color: #eee;
        border-radius: 10px;
        padding: 6px 10px;
        cursor: pointer;
      }
      .entity {
        position: absolute;
        transition: transform 0.1s linear;
      }
      .sprite {
        width: 56px;
        height: 56px;
      }
      .slash {
        position: absolute;
        width: 60px;
        height: 60px;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        opacity: 0;
        pointer-events: none;
      }
      .slash.show {
        animation: sl 0.16s ease forwards;
      }
      @keyframes sl {
        0% {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.6);
        }
        60% {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1.1);
        }
        100% {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.9);
        }
      }
      .touch {
        position: relative;
        display: none;
        gap: 10px;
        justify-content: center;
        margin: 10px auto 0;
      }
      .dpad {
        display: grid;
        grid-template: repeat(3, 50px) / repeat(3, 50px);
        gap: 6px;
        touch-action: none;
      }
      .dpad button,
      .tap {
        background: #22252a;
        border: 1px solid #2f3238;
        color: #eee;
        border-radius: 12px;
        font-weight: 700;
      }
      .dpad button:active,
      .tap:active {
        background: #2a2d34;
      }
      .tap {
        width: 110px;
        height: 110px;
        margin-left: 14px;
        touch-action: none;
      }
      .row {
        display: flex;
        justify-content: center;
      }
      .hide {
        display: none;
      }
      @media (max-width: 820px) {
        .touch {
          display: flex;
        }
        .hud div {
          padding: 5px 8px;
        }
        .btn {
          padding: 5px 8px;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div style="width: 100%; max-width: 820px">
        <h1>Cat & Mouse Hunt</h1>
        <small>Arrow buttons or keys • Space to swipe</small>
        <div id="board" class="game" tabindex="0">
          <div class="hud">
            <div>Score: <span id="score">0</span></div>
            <div>Time: <span id="time">60</span>s</div>
            <button id="reset" class="btn">Reset</button>
          </div>
          <div id="layer"></div>
          <div
            id="modal"
            style="
              display: none;
              position: absolute;
              inset: 0;
              align-items: center;
              justify-content: center;
              background: #000a;
            "
          >
            <div
              style="
                background: #111;
                padding: 14px 16px;
                border-radius: 10px;
                text-align: center;
              "
            >
              <h3>Time's up</h3>
              <p>Final score: <span id="final">0</span></p>
              <button id="again" class="btn">Play Again</button>
            </div>
          </div>
        </div>
        <div class="touch" id="touch">
          <div class="dpad" aria-label="move">
            <span></span><button data-k="ArrowUp">▲</button><span></span
            ><button data-k="ArrowLeft">◀</button><span></span
            ><button data-k="ArrowRight">▶</button><span></span
            ><button data-k="ArrowDown">▼</button><span></span>
          </div>
          <button class="tap" id="tap" aria-label="swipe">SWIPE</button>
        </div>
      </div>
    </div>
    <script>
      (function () {
        var COLS = 12,
          ROWS = 8;
        var TILE = 60;
        var MW = 720;
        function $(id) {
          return document.getElementById(id);
        }
        var board = $("board"),
          layer = $("layer"),
          scoreEl = $("score"),
          timeEl = $("time"),
          modal = $("modal"),
          final = $("final"),
          resetBtn = $("reset"),
          againBtn = $("again"),
          tapBtn = $("tap");
        var cat,
          mice = [],
          score = 0,
          time = 60,
          timer,
          spawner,
          walk,
          running = false;
        var catSVG =
          "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 56 56'><ellipse cx='28' cy='34' rx='16' ry='10' fill='%23000'/><circle cx='28' cy='22' r='9' fill='%23000'/><path d='M20 16l5-6 5 6' fill='%23000'/><path d='M31 16l5-6 5 6' fill='%23000'/><circle cx='25' cy='22' r='2' fill='%23fff'/><circle cx='31' cy='22' r='2' fill='%23fff'/><path d='M44 28c4 6-2 10-6 5' stroke='%23666' stroke-width='3' fill='none' stroke-linecap='round'/></svg>";
        var mouseSVG =
          "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 56 56'><ellipse cx='28' cy='32' rx='14' ry='9' fill='%23e6e6e6' stroke='%23cfcfcf'/><circle cx='38' cy='28' r='4' fill='%23d9d9d9'/><circle cx='22' cy='32' r='2' fill='%23000'/><path d='M40 36c6 2 8 6 0 8' stroke='%23bbb' stroke-width='2' fill='none' stroke-linecap='round'/></svg>";
        function place(el, x, y) {
          el.style.transform =
            "translate(" + x * TILE + "px," + y * TILE + "px)";
        }
        function makeCat() {
          var e = document.createElement("div");
          e.className = "entity";
          var i = document.createElement("img");
          i.className = "sprite";
          i.src = catSVG;
          e.appendChild(i);
          var sl = document.createElement("div");
          sl.className = "slash";
          sl.innerHTML =
            "<svg viewBox='0 0 60 60' width='60' height='60'><path d='M10 50 Q 30 35 50 10' stroke='white' stroke-width='6' fill='none'/></svg>";
          e.appendChild(sl);
          layer.appendChild(e);
          return { el: e, x: 1, y: 1, dir: "r", slash: sl };
        }
        function makeMouse(x, y) {
          var e = document.createElement("div");
          e.className = "entity";
          var i = document.createElement("img");
          i.className = "sprite";
          i.src = mouseSVG;
          e.appendChild(i);
          layer.appendChild(e);
          place(e, x, y);
          return { el: e, x: x, y: y };
        }
        function spawnMouseEdge() {
          var s = Math.floor(Math.random() * 4),
            x = 0,
            y = 0;
          if (s == 0) {
            x = 0;
            y = Math.floor(Math.random() * ROWS);
          } else if (s == 1) {
            x = COLS - 1;
            y = Math.floor(Math.random() * ROWS);
          } else if (s == 2) {
            y = 0;
            x = Math.floor(Math.random() * COLS);
          } else {
            y = ROWS - 1;
            x = Math.floor(Math.random() * COLS);
          }
          mice.push(makeMouse(x, y));
        }
        function swipe() {
          cat.slash.classList.remove("show");
          void cat.slash.offsetWidth;
          cat.slash.classList.add("show");
          var tx = cat.x + (cat.dir === "l" ? -1 : cat.dir === "r" ? 1 : 0),
            ty = cat.y + (cat.dir === "u" ? -1 : cat.dir === "d" ? 1 : 0),
            hit = mice.findIndex(function (m) {
              return (
                (m.x === cat.x && m.y === cat.y) || (m.x === tx && m.y === ty)
              );
            });
          if (hit != -1) {
            mice[hit].el.remove();
            mice.splice(hit, 1);
            scoreEl.textContent = ++score;
          }
        }
        function move(dx, dy, dir) {
          cat.dir = dir;
          cat.x = Math.max(0, Math.min(COLS - 1, cat.x + dx));
          cat.y = Math.max(0, Math.min(ROWS - 1, cat.y + dy));
          place(cat.el, cat.x, cat.y);
        }
        function tick() {
          time--;
          timeEl.textContent = time;
          if (time <= 0) end();
        }
        function end() {
          running = false;
          clearInterval(timer);
          clearInterval(spawner);
          clearInterval(walk);
          final.textContent = score;
          modal.style.display = "flex";
        }
        function reset() {
          clearInterval(timer);
          clearInterval(spawner);
          clearInterval(walk);
          layer.innerHTML = "";
          score = 0;
          scoreEl.textContent = 0;
          time = 60;
          timeEl.textContent = 60;
          mice = [];
          cat = makeCat();
          place(cat.el, cat.x, cat.y);
          modal.style.display = "none";
          running = true;
          timer = setInterval(tick, 1000);
          spawner = setInterval(spawnMouseEdge, 1000);
          walk = setInterval(function () {
            if (!running) return;
            mice.forEach(function (m) {
              var d = Math.floor(Math.random() * 4),
                nx = m.x + (d === 0 ? 1 : d === 1 ? -1 : 0),
                ny = m.y + (d === 2 ? 1 : d === 3 ? -1 : 0);
              nx = Math.max(0, Math.min(COLS - 1, nx));
              ny = Math.max(0, Math.min(ROWS - 1, ny));
              m.x = nx;
              m.y = ny;
              place(m.el, nx, ny);
            });
          }, MW);
        }
        function key(e) {
          if (!running) return;
          var k = e.key;
          if (
            ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight", " "].includes(k)
          )
            e.preventDefault();
          if (k === "ArrowUp") move(0, -1, "u");
          else if (k === "ArrowDown") move(0, 1, "d");
          else if (k === "ArrowLeft") move(-1, 0, "l");
          else if (k === "ArrowRight") move(1, 0, "r");
          else if (k === " ") swipe();
        }
        function resize() {
          var vw = Math.min(window.innerWidth, 820) - 16;
          var th = vw / COLS;
          TILE = Math.max(34, Math.min(64, Math.floor(th)));
          board.style.width = COLS * TILE + "px";
          board.style.height = ROWS * TILE + "px";
          if (cat) place(cat.el, cat.x, cat.y);
          mice.forEach(function (m) {
            place(m.el, m.x, m.y);
          });
        }
        window.addEventListener("resize", resize);
        window.addEventListener("orientationchange", resize);
        document.querySelectorAll(".dpad button").forEach(function (b) {
          b.addEventListener(
            "touchstart",
            function (e) {
              e.preventDefault();
              window.dispatchEvent(
                new KeyboardEvent("keydown", { key: b.dataset.k })
              );
            },
            { passive: false }
          );
          b.addEventListener("mousedown", function () {
            window.dispatchEvent(
              new KeyboardEvent("keydown", { key: b.dataset.k })
            );
          });
        });
        tapBtn.addEventListener(
          "touchstart",
          function (e) {
            e.preventDefault();
            window.dispatchEvent(new KeyboardEvent("keydown", { key: " " }));
          },
          { passive: false }
        );
        tapBtn.addEventListener("mousedown", function () {
          window.dispatchEvent(new KeyboardEvent("keydown", { key: " " }));
        });
        resetBtn.onclick = reset;
        againBtn.onclick = reset;
        window.addEventListener("keydown", key, { passive: false });
        resize();
        reset();
      })();
    </script>
  </body>
</html>
